// homophone-cipher.js ‚Äî —Ç–≤–æ—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ JS

const listslist = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19];

const alfa =['–∞', '–±', '–≤', '–≥', '–¥', '–µ', '—ë', '–∂', '–∑', '–∏', '–π', '–∫', '–ª', '–º', '–Ω', '–æ', '–ø', '—Ä', '—Å', '—Ç', '—É', '—Ñ', '—Ö', '—Ü', '—á', '—à', '—â', '—ä', '—ã', '—å', '—ç', '—é', '—è'];

const alphabet =['+', '‚àí', '√ó', '√∑', '=', '‚â†', '‚âà', '‚â°', '‚â§', '‚â•', '‚â™', '‚â´', '¬±', '‚àì', '‚àö', '‚àõ', '‚àú', '‚àë', '‚àè', '‚à´', '‚àÇ', '‚àá', '‚àû', '‚àÖ', '‚àà', '‚àâ', '‚äÇ', '‚äÉ', '‚à©', '‚à™', '‚àß', '‚à®', '¬¨'];

const ss =['—£', '—ß', '—´', '—≠', '—Ø', '—±', '—≥', '—µ', '“Å', '—π', '—ª', '—Ω', '—ø', '—î', '—•', '—°', '—ï', 'Íôë', 'Íôì', 'Íôï', '¬Æ', 'Íôô', 'Íôõ', 'Íôù', 'Íôü', 'Íô£', 'Íô•', 'Íôß', 'Íô©', 'Íô´', 'Íô≠', 'ÍöÅ', 'ÍöÉ'];

const ll=['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '√¶', '≈ì', '√∞', '√æ', '√ü', '√∏', '√•'];

const greek=['Œ±', 'Œ≤', 'Œ≥', 'Œ¥', 'Œµ', 'Œ∂', 'Œ∑', 'Œ∏', 'Œπ', 'Œ∫', 'Œª', 'Œº', 'ŒΩ', 'Œæ', 'Œø', 'œÄ', 'œÅ', 'œÉ', 'œÇ', 'œÑ', 'œÖ', 'œÜ', 'œá', 'œà', 'œâ', 'œä', 'œã', 'œå', 'œç', 'œé', '·ºÄ', '·ºê', '·ΩÄ'];

const ts=['Àí', 'Àì', 'Àî', 'Àï', 'Àñ', 'Àó', 'Àò', 'Àô', 'Àö', 'Àõ',
'Àû', 'Àü', 'À•', 'À¶', 'Àß', 'À®', 'À©', 'À™', 'À´', 'À≠',
'À≥', 'À∑', 'Àπ', 'À∫', 'Àª', 'Àº', 'ÀΩ', 'Àæ',
'…ê', '…ë', '…í', ' û', ' ü'];

const geometric=['‚ñ†', '‚ñ°', '‚ñ¢', '‚ñ£', '‚ñ§', '‚ñ•', '‚ñ¶', '‚ñß', '‚ñ®', '‚ñ©', '‚ñ™', '‚ñ´',
'‚ñ¨', '‚ñ≠', '‚ñÆ', '‚ñØ', '‚ñ∞', '‚ñ±', '‚ñ≤', '‚ñ≥', '‚ñ¥', '‚ñµ',
'‚Øà', '‚Øá', '‚ñ∏', '‚ñπ', '‚ñ∫', '‚ñª', '‚ñº', '‚ñΩ', '‚ñæ', '‚ñø', '‚ØÖ'];

const arrows=['‚áê', '‚áë', '‚áí', '‚áì', '‚áî', '‚áï', '‚áñ', '‚áó', '‚áò', '‚áô', '‚áö', '‚áõ',
'‚áú', '‚áù', '‚áû', '‚áü', '‚á†', '‚á°', '‚á¢', '‚á£', '‚á§', '‚≠≤', '‚á¶', '&',
'‚á®', '‚á©', '‚á™', '‚á¥', '‚áµ', '‚á∂', '‚á∑', '‚á∏', '‚áπ'];

const mrs=['‚âº', '‚âΩ', '‚âæ', '‚âø', '‚äÄ', '‚äÅ', '‚äè', '‚äê', '‚äë', '‚äí', '‚ãê', '‚ãë',
'‚ãñ', '‚ãó', '‚ãò', '‚ãô', '‚ãö', '‚ãõ', '‚ãú', '‚ãù', '‚ãû', '‚ãü', '‚ã†', '‚ã°',
'‚ã¢', '‚ã£', '‚ã§', '‚ã•', '‚ã¶', '‚ãß', '‚ã®', '‚ã©', '‚ã™'];

const ls=['‚ä¢', '‚ä£', '‚ä§', '‚ä•', '‚ä∏', '‚äª', '‚äº', '‚äΩ', '‚äæ', '‚äø',
'‚ãÄ', '‚ãÅ', '‚ãÇ', '‚ãÉ', '‚©ì', '‚©î',
'‚©§', '‚©•', '‚©¶', '‚©ß', '‚©®', '‚©©', '‚©™', '‚©´',
'‚©¨', '‚©≠', '‚©Æ', '‚©Ø', '‚©∞', '‚©±', '‚©≤', '‚©≥', '‚©¥'];

const ac=['‚Öø', '‚§µ', '‚§∂', '‚§∑', '‚§∏', '‚§π', '‚§∫', '‚§ª', '‚§º', '‚§Ω', '‚§æ', '‚§ø',
'‚•Ä', '‚•Å', '‚•Ç', '‚•É', '‚•Ñ', '‚•Ö', '‚•Ü', '‚•á', '‚•à', '‚•â', '‚•ä', '‚•ã',
'‚•å', '‚•ç', '‚•é', '‚•è', '‚•ê', '‚•ë', '‚•í', '‚•ì', '‚•î'];

const gs=['‚óÅ','‚ó¢','‚ó£','‚ó§','‚ó•','‚ó∏','‚óπ','‚ó∫','‚óª','‚óΩ','‚óæ','‚óø','‚ßã','‚ßå','‚ßç','‚ßé','‚ßè','‚ßê',
'‚ßë','‚ßí','‚ßì','‚ßî','‚ßï','‚ßñ','‚ßó','‚ßò','‚ßô','‚ßö','‚ßõ','‚Ñª','‚Ñº','‚ÑΩ','‚óâ'];

const be=['‚ü¶', '‚üß', '‚ü®', '‚ü©', '‚ü™', '‚ü´', '‚ü¨', '‚ü≠', '‚üÆ', '‚Ä∞', '‚¶É', '‚¶Ñ',
'‚¶Ö', '‚¶Ü', '‚¶á', '‚¶à', '‚¶â', '‚¶ä', '‚¶ã', '‚¶å', '‚¶ç', '‚¶é', '‚¶è', '‚¶ê',
'‚¶ë', '‚¶í', '‚¶ì', '‚¶î', '‚¶ï', '‚¶ñ', '‚¶ó', '‚¶ò', '‚ßº'];

const cs=['‚®Ä', '‚®Å', '‚®Ç', '‚®É', '‚®Ñ', '‚®Ö', '‚®Ü', '‚®á', '‚®à', '‚®â', '‚®ä', '‚®ã',
'‚®å', '‚®ç', '‚®é', '‚®è', '‚®ê', '‚®ë', '‚®í', '‚®ì', '‚®î', '‚®ï', '‚®ñ', '‚®ó',
'‚®ò', '‚®ô', '‚®ö', '‚®õ', '‚®ú', '‚®ù', '‚®û', '‚®ü', '‚®†'];

const tm=['‚Ñô','‚Ñö','‚Ñõ','‚Ñú','_','‚Ñû','‚Ñü',
'‚Ñ†','‚Ñ°','‚Ñ¢','‚Ñ£',
'‚Ñ§','‚Ñ•','‚Ñ¶','‚Ñß','‚Ñ®','‚Ñ©','‚Ñ™','‚Ñ´','‚Ñ¨','‚Ñ≠','‚ÑÆ',
'‚ÑØ','‚Ñ∞','‚Ñ±','‚Ñ≤','‚Ñ≥','‚Ñ¥','‚Ñµ','‚Ñ∂','‚Ñ∑','‚Ñ∏','‚Öí'];

const pe=['‚Äπ','‚Ä∫','¬´','¬ª','‚Äû','‚Äú','‚Äù','‚Äü','‚Äõ','‚ÄΩ','‚Ä¥','‚Äµ',
'‚Ä∂','‚Ä∑','‚Ä∏','‚Äª','‚Äº','‚Åà','‚Åá',
'‚∏Ä','‚∏Å','‚∏Ç','‚∏É','‚∏Ñ','‚∏Ö','‚∏Ü','‚∏á',
'‚∏à','‚∏â','‚∏ä','‚∏ã','‚∏å','‚∏Æ'];

const ms=['‚©µ', '‚©∂', '‚©∑', '‚©∏', '‚©π', '‚©∫', '‚©ª', '‚©º', '‚©Ω', '‚©æ', '‚©ø', '‚™Ä',
'‚™Å', '‚™Ç', '‚™É', '‚™Ñ', '‚™Ö', '‚™Ü', '‚™á', '‚™à', '‚™â', '‚™ä', '‚™ã', '‚™å',
'‚™ç', '‚™é', '‚™è', '‚™ê', '‚™ë', '‚™í', '‚™ì', '‚™î', '‚™ï'];

const bd=['‚îÄ', '‚îÅ', '‚îÇ', '‚îÉ', '‚îÑ', '‚îÖ', '‚îÜ', '‚îá', '‚îà', '‚îâ', '‚îä',
'‚îã', '‚îå', '‚îç', '‚îé', '‚îè', '‚îê', '‚îë', '‚îí', '‚îì', '‚îî',
'‚îï', '‚îñ', '‚îó', '‚îò', '‚îô', '‚îö', '‚îõ', '‚îú', '‚îù', '‚îû', '‚îü', '‚î†'];

const braille=['‚†Å', '‚†Ç', '‚†É', '‚†Ñ', '‚†Ö', '‚†Ü', '‚†á', '‚†à', '‚†â', '‚†ä', '‚†ã',
'‚†å', '‚†ç', '‚†é', '‚†è', '‚†ê', '‚†ë', '‚†í', '‚†ì', '‚†î', '‚†ï',
'‚†ñ', '‚†ó', '‚†ò', '‚†ô', '‚†ö', '‚†õ', '‚†ú', '‚†ù', '‚†û', '‚†ü', '‚††', '‚†°'];

const cu=['¬¢', '¬£', '¬§', '¬•', '÷è', 'ÿã', '‡ß≤', '‡ß≥', '‡ßª', '‡´±', '‡Øπ',
'‡∏ø', '·üõ', '‚Ç†', '‚Ç°', '‚Ç¢', '‚Ç£', '‚Ç§', '‚Ç•', '‚Ç¶', '‚Çß',
'‚Ç®', '‚Ç©', '‚Ç™', '‚Ç´', '‚Ç¨', '‚Ç≠', '‚ÇÆ', '‚ÇØ', '‚Ç∞', '‚Ç±', '‚Ç≤', '‚Ç≥'];

const spaces=['‚Å∞', '¬π', '¬≤', '¬≥', '‚Å¥', '‚Åµ', '‚Å∂', '‚Å∑', '‚Å∏', '‚Åπ',
'‚Å∫', '‚Åª', '‚Åº', '‚ÅΩ', '‚Åæ',
'‚Å±', '‚Åø',
'‚ÇÄ', '‚ÇÅ', '‚ÇÇ', '‚ÇÉ', '‚ÇÑ', '‚ÇÖ', '‚ÇÜ', '‚Çá', '‚Çà', '‚Çâ',
'‚Çä', '‚Çã', '‚Çå', '‚Çç', '‚Çé','·µÉ'];

const dots=['‚Ññ','‚Ñó','‚Ñò','‚Ñæ','‚Ñø',
'‚ÑÄ','‚ÑÅ','‚ÑÇ','‚ÑÉ','‚ÑÑ','‚ÑÖ','‚ÑÜ','‚Ñá','‚Ñà','‚Ñâ','‚Ñä',
'‚Ñã','‚Ñå','‚Ñç','‚Ñé','‚Ñè','‚Ñê','‚Ñë','‚Ñí','‚Ñì','‚Ñî','‚Ñï',
'¬∞', '¬™', '¬∫', '¬µ', '¬∂', '¬ß'];

const commas=['…ì', '…ó', '…†', '…¶', '…±', '…≤', '…≥', '…∏', '…∫', '…ª', '…º',
'…Ω', ' Ç', ' É', ' à', ' â', ' ä', 
' ê', ' ë', ' í', ' î', ' ï', ' ò', '«Ä', '«Å', '«Ç', '«É', 'ÀÄ', 'ÀÅ',
'…ü', '…°', '…•', '…®'];

const dash=['‚ë†','‚ë°','‚ë¢','‚ë£','‚ë§','‚ë•','‚ë¶','‚ëß','‚ë®','‚ë©',
'‚ë™','‚ë´','‚ë¨','‚ë≠','‚ëÆ','‚ëØ','‚ë∞','‚ë±','‚ë≤','‚ë≥',
'„âë','„âí','„âô','„âö','„âõ','„âú','„âù',
'‚ù∂', '‚ù∑', '‚ù∏', '‚ùπ', '‚ù∫', '‚ùª'];

const mark1 =['’°','’¢','’£','’§','’•','’¶','’ß','’®','’©','’™','’´','’¨','’≠','’Æ','’Ø',
'’∞','’±','’≤','’≥','’¥','’µ','’∂','’∑','’∏','’π','’∫','’ª','’º','’Ω','’æ',
'’ø','÷Ä','÷Å'];

const mark2 =['‚ôî','‚ôï','‚ôñ','‚ôó','‚ôò','‚ôô','‚ôö','‚ôõ','‚ôú','‚ôù','‚ôû','‚ôü',
'‚öÄ','‚öÅ','‚öÇ','‚öÉ','‚öÑ','‚öÖ',
'ü®Ä', 'ü®Å', 'ü®Ç', 'ü®É', 'ü®Ñ', 'ü®Ö', 'ü®Ü', 'ü®á', 'ü®à', 'ü®â', 'ü®ä', 'ü®ã', 'ü®å', 'ü®ç', 'ü®é'];

const colon=['‚Ö†','‚Ö°','‚Ö¢','‚Ö£','‚Ö§','‚Ö•','‚Ö¶','‚Öß','‚Ö®','‚Ö©','‚Ö™','‚Ö´','‚Ö¨','‚Ö≠','‚ÖÆ','‚ÖØ','‚Ö±','‚Ö≤','‚Ö≥','‚Ö¥','‚Öµ','‚Ö∂','‚Ö∑','‚Ö∏','‚Öπ','‚Ö∫','‚Öº','‚ÖΩ','‚Öæ',
'‚ÜÄ','‚ÜÅ','‚ÜÇ', '‚ÜÉ'];

const spam = [
 '‚åò','‚å•','‚åÉ','‚áß','‚å´','‚å¶','‚≠æ','‚éã','‚èö','‚ôØ','‚ô≠','‚ô™','‚ô´', '$','#','‚úì','‚úó','„âì','„âî','„âï','„âñ','„âó','„âò',
 '‚ú©','‚ú™','‚ú¶','‚ú∞','‚ûî','‚ûú','‚û§',' ã',' å',' ç',
 '‚à¥','‚àµ','‚à∂','‚à∑','‚àª','‚àº','‚âÉ','‚âÖ','‚âç','‚âé','‚âê','‚âë','¬∑','‚Ä¶','‚Ä•','‚Äß','‚Ä†','‚Ä°','¬©','‚àó', '‚àù', '‚à†', '‚à°', '‚à¢', '‚à£', '‚à§', '‚à•', '‚à¶', '‚äô', '‚äó',
 '‚äò', '‚äñ', '‚äõ', '‚äù', '‚äö', '‚ãÜ', '‚ãÑ', '‚óç', '‚óê', '‚óë'];

const one = [
 '·ö¢','·ö¶','·ö®','·ö±','·ö≤','·ö∑','·öπ','·ö∫','·öæ','·õÅ','·õÉ',
 '·õá','·õà','·õâ','·õä','·õè','·õí','·õñ','·õó','·õö','·õú',
 '·õû','·õü','·õ†','·õ°','·õ¢','·õ£','·õ§','·õ•','·õ¶','·õß','·õ®','·õ©'
];

const two = [
 '·öÅ','·öÇ','·öÉ','·öÑ','·öÖ','·öÜ','·öá','·öà','·öâ','·öä','·öã',
 '·öå','·öç','·öé','·öè','·öê','·öë','·öí','·öì','·öî','·öï',
 '·öñ','·öó','·öò','·öô','·öö','·öõ','·öú','·öù','·öû','·öü','·ö™','·ö´'
];

const three = [
 '·é†','·é°','·é¢','·é£','·é§','·é•','·é¶','·éß','·é®','·é©','·é™',
 '·é´','·é¨','·é≠','·éÆ','·éØ','·é∞','·é±','·é≤','·é≥','·é¥',
 '·éµ','·é∂','·é∑','·é∏','·éπ','·é∫','·éª','·éº','·éΩ','·éæ','·éø','·èÄ'
];

const four = [
 '·êÅ','·êÇ','·êÉ','·êÑ','·êÖ','·êÜ','·êä','·êã','·êØ','·ê∞','·ê±',
 '·ê≤','·ê≥','·ê¥','·ê∏','·êπ','·ê∫','·êª','·êº','·êΩ','·êæ',
 '·êø','·ëÄ','·ëÅ','·ëÇ','·ëÉ','·ëÑ','·ëÖ','·ëÜ','·ëá','·ëà','·ëâ','·ëä'
];

const five = [
 '‚¥∞','‚¥±','‚¥≤','‚¥≥','‚¥¥','‚¥µ','‚¥∂','‚¥∑','‚¥∏','‚¥π','‚¥∫',
 '‚¥ª','‚¥º','‚¥Ω','‚¥æ','‚¥ø','‚µÄ','‚µÅ','‚µÇ','‚µÉ','‚µÑ',
 '‚µÖ','‚µÜ','‚µá','‚µà','‚µâ','‚µä','‚µã','‚µå','‚µç','‚µé','‚µè','‚µê'
];

const six = [
 '…ï','…ñ','…≠','…æ','…ø',' Ä',' Å',' Ö',' Ü',' é',' è',
 ' ú',' ù',' †',' £',' §',' •',' ¶',' ß',' ®',' ©',
 ' ™',' ´',' ¨',' ≠',' Æ',' Ø',' ¥',' µ',' ∂',' ∑',' ∏',' π'
];

const seven = [
 '·µá','·µà','·µâ','·µç','·µè','·µê','·µí','·µñ','·µó','·µò','·µõ',
 '·µù','·µû','·µü','·µ†','·µ°','·µ¢','·µ£','·µ§','·µ•','·µ¶',
 '·µß','·µ®','·µ©','·µ™','·µ´','·µ¨','·µ≠','·µÆ','·µØ','·µ∞','·µ±','·µ≤'
];

const eight = [
 '‚Ç¥', '‚Çµ', '‚Ç∂', '‚Ç∑', '‚Ç∏', '‚Çπ', '‚Ç∫', '‚Çª', '‚Çº', '‚ÇΩ', '‚Çæ', '‚Çø', '‚ÉÄ', '‚Ñ∫', '‚ÖÄ', '‚ÖÅ', '‚ÖÇ', '‚ÖÉ', '‚ÖÑ', '‚Öä', '‚Öã', '‚Öå', '‚Öç', '‚Öè', '‚Üä', '‚Üã', '‚Üê', '‚Üë', '‚Üí', '‚Üì', '‚Üî', '‚Üï', '‚Üñ'
];

const nine = [
 'ùíÇ','ùíÉ','ùíÑ','ùíÖ','ùíÜ','ùíá','ùíà','ùíâ','ùíä','ùíã','ùíå',
 'ùíç','ùíé','ùíè','ùíê','ùíë','ùíí','ùíì','ùíî','ùíï','ùíñ',
 'ùíó','ùíò','ùíô','ùíö','ùíõ','ùì™','ùì´','ùì¨','ùì≠','ùìÆ','ùìØ','ùì∞'
];


const zero = [ 'êÑá','êÑà','êÑâ','êÑä','êÑã','êÑå','êÑç','êÑé','êÑè','êÑê','êÑë',
 'êÑí','êÑì','êÑî','êÑï','êÑñ','êÑó','êÑò','êÑô','êÑö','êÑõ',
 'êÑú','êÑù','êÑû','êÑü','êÑ†','êÑ°','êÑ¢','êÑ£','êÑ§','êÑ•','êÑ¶','êÑß'
];

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function randomChoice(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
}

function shuffle(lists, key) {
    let keys = key.split('.').filter(k => k !== '');
    let newLists = lists.map(list => [...list]); // –≥–ª—É–±–æ–∫–∞—è –∫–æ–ø–∏—è
    for (let i = 0; i < newLists.length; i++) {
        let shifts = parseInt(keys[i]) || 0;
        for (let j = 0; j < shifts; j++) {
            let last = newLists[i].pop();
            newLists[i].unshift(last);
        }
    }
    return newLists;
}

function position(lists, key0) {
    let keys = key0.split('.').filter(k => k !== '');
    return keys.map(k => lists[parseInt(k)]);
}

// === –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ===
function encryptMessage(text, key, key0) {
    if (!text) return '';

    const baseLists = [alphabet, ss, ll, greek, ts, geometric, arrows, mrs, ls, ac, gs, be, cs, tm, pe, ms, bd, braille, cu, dots, commas, dash, mark1, mark2, colon, spam, one, two, three, four, five, six, seven, eight, nine, zero, spaces];

    let shuffled = shuffle(baseLists, key);
    let positioned = position(shuffled, key0);

    let l = text.split('');
    let result = [];

    for (let char of l) {
        // —Å–ø–∞–º
        let z = Math.floor(Math.random() * 10) + 1;
        for (let j = 0; j < z; j++) {
            result.push(randomChoice(spam));
        }

        let x = randomChoice(listslist);

        if (char === ' ') { result.push(randomChoice(spaces)); continue; }
        if (char === '.') { result.push(randomChoice(dots)); continue; }
        if (char === ',') { result.push(randomChoice(commas)); continue; }
        if (char === '-' || char === '‚Äî') { result.push(randomChoice(dash)); continue; }
        if (char === '!') { result.push(randomChoice(mark1)); continue; }
        if (char === '?') { result.push(randomChoice(mark2)); continue; }
        if (char === ':') { result.push(randomChoice(colon)); continue; }
        if (char === '1') { result.push(randomChoice(one)); continue; }
        if (char === '2') { result.push(randomChoice(two)); continue; }
        if (char === '3') { result.push(randomChoice(three)); continue; }
        if (char === '4') { result.push(randomChoice(four)); continue; }
        if (char === '5') { result.push(randomChoice(five)); continue; }
        if (char === '6') { result.push(randomChoice(six)); continue; }
        if (char === '7') { result.push(randomChoice(seven)); continue; }
        if (char === '8') { result.push(randomChoice(eight)); continue; }
        if (char === '9') { result.push(randomChoice(nine)); continue; }
        if (char === '0') { result.push(randomChoice(zero)); continue; }

        let lower = char.toLowerCase();
        if (!alfa.includes(lower)) {
            result.push(char);
            continue;
        }

        let f = alfa.indexOf(lower);

        if (x === 1) result.push(positioned[0][f]);
        else if (x === 2) result.push(positioned[1][f]);
        else if (x === 3) result.push(positioned[2][f]);
        else if (x === 4) result.push(positioned[3][f]);
        else if (x === 5) result.push(positioned[4][f]);
        else if (x === 6) result.push(positioned[5][f]);
        else if (x === 7) result.push(positioned[6][f]);
        else if (x === 8) result.push(positioned[7][f]);
        else if (x === 9) result.push(positioned[8][f]);
        else if (x === 10) result.push(positioned[9][f]);
        else if (x === 11) result.push(positioned[10][f]);
        else if (x === 12) result.push(positioned[11][f]);
        else if (x === 13) result.push(positioned[12][f]);
        else if (x === 14) result.push(positioned[13][f]);
        else if (x === 15) result.push(positioned[14][f]);
        else if (x === 16) result.push(positioned[15][f]);
        else if (x === 17) result.push(positioned[16][f]);
        else if (x === 18) result.push(positioned[17][f]);
        else if (x === 19) result.push(positioned[18][f]);
        else result.push(char);
    }
    return result.join('');
}

function decryptMessage(ciphertext, key, key0) {
    if (!ciphertext) return '';

    const baseLists = [alphabet, ss, ll, greek, ts, geometric, arrows, mrs, ls, ac, gs, be, cs, tm, pe, ms, bd, braille, cu, dots, commas, dash, mark1, mark2, colon, spam, one, two, three, four, five, six, seven, eight, nine, zero, spaces];

    let shuffled = shuffle(baseLists, key);
    let positioned = position(shuffled, key0);

    let l = ciphertext.split('');
    let result = [];

    for (let i = 0; i < l.length; i++) {
        let char = l[i];

        if (char === ' ') { result.push(''); continue; }
        if (spaces.includes(char)) { result.push(' '); continue; }
        if (spam.includes(char)) continue;
        if (dots.includes(char)) { result.push('.'); continue; }
        if (commas.includes(char)) { result.push(','); continue; }
        if (dash.includes(char)) { result.push('-'); continue; }
        if (mark1.includes(char)) { result.push('!'); continue; }
        if (mark2.includes(char)) { result.push('?'); continue; }
        if (colon.includes(char)) { result.push(':'); continue; }

        if (one.includes(char)) { result.push('1'); continue; }
        if (two.includes(char)) { result.push('2'); continue; }
        if (three.includes(char)) { result.push('3'); continue; }
        if (four.includes(char)) { result.push('4'); continue; }
        if (five.includes(char)) { result.push('5'); continue; }
        if (six.includes(char)) { result.push('6'); continue; }
        if (seven.includes(char)) { result.push('7'); continue; }
        if (eight.includes(char)) { result.push('8'); continue; }
        if (nine.includes(char)) { result.push('9'); continue; }
        if (zero.includes(char)) { result.push('0'); continue; }

        // –æ—Å–Ω–æ–≤–Ω–æ–π –±–ª–æ–∫
        let found = false;
        for (let p = 0; p < positioned.length; p++) {
            let idx = positioned[p].indexOf(char);
            if (idx !== -1) {
                result.push(alfa[idx]);
                found = true;
                break;
            }
        }
        if (!found) {
            result.push(char); // –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–∏–º–≤–æ–ª
        }
    }
    return result.join('');
}

// === –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ï –ö–õ–Æ–ß–ò (–∏–∑ —Ç–≤–æ–µ–≥–æ main.py) ===
const HOMOPHONE_KEY = "3.18.25.6.12.30.21.9.15.1.28.33.10.20.27.36.1.23.5.7.13.16.4.31.22.34.8.14.2.19.35.11.24.29.17.26.32.";
const HOMOPHONE_KEY0 = "14.2.31.7.19.26.11.1.35.8.22.0.16.33.28.13.30.5.18.9.24.3.32.20.15.10.25.6.23.34.29.12.21.4.27.17.36.";
